---
description: Автоматически синхронизировать правила и документацию с изменениями кода
alwaysApply: true
---

# Синхронизация кода, правил и документации

## Правило

При внесении изменений в код, которые влияют на архитектуру, API, паттерны или поведение системы:

1. **Проверь соответствие**: Сравни изменения с существующими правилами и документацией
2. **Обнови документы**: Если код больше не соответствует правилам/документации, обнови их:
   - `.cursor/rules/*.mdc` — правила для AI агента
   - `README.md` — основная документация
   - `example/lib/features/*/README.md` — документация модулей
   - `AGENTS.md` — критические архитектурные правила

3. **Что обновлять**:
   - ❌ Код изменен → документация устарела → обнови документацию
   - ✅ Документация актуальна → код соответствует → ничего не делай

## Примеры

### Изменение API

```dart
// Было в документации: controller.play()
// Стало в коде: controller.playVideo()
```

→ Обнови все упоминания `play()` на `playVideo()` в README.md, правилах, примерах.

### Изменение архитектуры

```dart
// Было: VideoControls использует StatefulWidget
// Стало: VideoControls использует StatelessWidget + StateManager
```

→ Обнови `player-controls-structure.mdc`, `README.md` с новой архитектурой.

### Добавление новой фичи

```dart
// Добавлен: controller.setPictureInPictureMode()
```

→ Добавь описание PiP в README.md, обнови список фич в `rhs-player-context.mdc`.

## Процесс

1. Внеси изменения в код
2. Прогони `fvm dart format .`
3. Проверь `.cursor/rules/*.mdc` и README.md
4. Обнови устаревшие разделы
5. Коммит включает и код, и документацию

## Не обновлять

- Мелкие рефакторинги без изменения API
- Внутренние приватные методы
- Форматирование и стиль кода
